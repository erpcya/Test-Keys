apply plugin: 'application'

java {
	sourceCompatibility = JavaVersion.VERSION_1_8
    targetCompatibility = JavaVersion.VERSION_1_8
}

repositories {
    jcenter()
    flatDir {
       dirs 'dependences', 'lib'
	}
}

sourceSets {
    main {
         java {
            srcDirs = ['src/main/java']
         }
    }
}

startScripts.enabled = false

task CreateRunnable(type: CreateStartScripts) {
    mainClassName = 'org.spin.test.TestKey'
    applicationName = 'test-keys'
    outputDir = new File(project.buildDir, 'tmp')
    classpath = jar.outputs.files + project.configurations.runtime
}

applicationDistribution.into('bin') {
	from(CreateRunnable)
	fileMode = 0755
}

//	Create release for project
task createRelease(type: Copy) {
   dependsOn build
   from file("$buildDir/distributions/")
   into file("$buildDir/release/")
   //destinationDir(file('build/release/'))
   doLast {
        file('build/release/')
        	.listFiles({file -> file.isFile()} as FileFilter).sort()
        	.each { File file ->
            ant.checksum file: file
        }
   	}
}